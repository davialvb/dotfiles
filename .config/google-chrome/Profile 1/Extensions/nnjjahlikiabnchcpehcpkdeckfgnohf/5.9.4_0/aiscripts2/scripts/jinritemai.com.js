function aiparser(t){var e=0;function n(t,e){return(Array(e).join(0)+t).slice(-e)}function o(n){new ParsedPItem({src:n.src.match("^http")?n.src:location.protocol+n.src,alt:n.alt,group:n.group,groupIndex:n.groupIndex},e++,t,function(e){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:t.id,item:e})})}var a=location.href.match("\\bid=(\\d+)")[1];if(location.href.match("/views/product/(detail|item)"))window.addEventListener("message",t=>{if("ftk_fetch"==t.data.topic){var a=t.data.data,i=a[0].data.img_list,r=a[1].data.pic_map;i.forEach((t,e)=>o({src:t,alt:`主图-${n(e+1,2)}`,group:"主图",groupIndex:0})),a[0].data.spec_info[0].list.forEach((t,e)=>{o({src:`https://sf1-ttcdn-tos.pstatp.com/obj/${r[t.id]}`,alt:"SKU-"+n(e+1,2)+"-"+t.name,group:"SKU",groupIndex:1})}),a[0].data.description.match(/src="(.*?)"/g).map(t=>t.match('"(.*)"')[1]).forEach(t=>{o({src:t,alt:`详情-${n(e+1,2)}`,group:"详情",groupIndex:2})})}}),(i=document.createElement("script")).innerText=`\n    Promise.all([\n        fetch( 'https://ec.snssdk.com/product/fxgajaxstaticitem?b_type_new=0&device_id=0&is_outside=1&id=${a}&preview=0&is_native_h5=1').then(res => res.json()),\n        fetch( 'https://ec.snssdk.com/product/getstock?id=${a}&add_cart=0&b_type_new=0&device_id=0&is_outside=1').then(res => res.json())\n    ]).then(values => {\n        debugger;\n        window.postMessage({\n            topic: 'ftk_fetch',\n            data: values\n        }, '*');\n    })\n    `,document.body.appendChild(i);else if(location.href.match("/ecommerce/trade/detail/index.html")){let t=document.querySelector(".title-info__title");var i;window.ftk_docTitle=t?t.textContent:document.title,window.addEventListener("message",t=>{if("ftk_fetch"==t.data.topic){let r=[];var o=t.data.data,a=o[0].promotions[0].base_info.images,i=o[0].promotions[0].detail_info.detail_imgs;a.forEach((t,e)=>r.push({src:t.url_list[0].replace("http://","https://"),alt:`主图-${n(e+1,2)}`,group:"主图",docTitle:window.ftk_docTitle,groupIndex:0})),i.forEach(t=>{r.push({src:t.url_list[0].replace("http://","https://"),alt:`详情-${n(e+1,2)}`,group:"详情",docTitle:window.ftk_docTitle,groupIndex:2})}),chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:r})}}),(i=document.createElement("script")).innerText=`\n    Promise.all([\n        fetch( 'https://api5-normal-c-hl.amemv.com/aweme/v2/shop/promotion/pack/?is_h5=1', {\n            method: 'POST',\n            headers: {\n                'content-type': 'application/x-www-form-urlencoded; charset=UTF-8;'\n            },\n            body: 'promotion_ids=${a}&use_new_price=true&is_h5=1&bff_type=2'\n        }).then(res => res.json()),\n    ]).then(values => {\n        debugger;\n        window.postMessage({\n            topic: 'ftk_fetch',\n            data: values\n        }, '*');\n    })\n    `,document.body.appendChild(i)}}window.aiparser=aiparser;