function aiparser(e){if(window==top){var r=0;if(chrome.runtime.sendMessage({cmd:"SET_GROUPS",groups:["主图","视频","SKU图片","详情"]}),!location.href.match("store/product|/item/"))return-1;var t=1;document.querySelectorAll('#j-image-thumb-list img, .images-view-list img, [class^="Product_GalleryBar__bar"] img').forEach(function(e){l({src:e.src,group:"主图",groupIndex:0,alt:"主图Main-"+d(t++,2)})});var a=document.querySelector('#item-video, [class^="Product_GalleryVideo__video"]');a&&new VItem({src:a.src,group:"视频",groupIndex:1},r++,e,function(r){chrome.runtime.sendMessage({cmd:"ADD_VIDEO",tabId:e.id,item:r})});var o=1;document.querySelectorAll('#j-sku-list-1 img,.sku-property-list img, [class^="Product_SkuValuesBar__container"] img').forEach(function(e){l({src:e.src,group:"SKU图片",groupIndex:2,alt:"SKU-"+d(o++,2)+(e.alt?"-"+e.alt:"")})});var n=document.querySelectorAll('.description-content img, #product-description img, [class^="ProductDescription-module_content"] img, .detailmodule_image img, .detailmodule_html img, [class^="ProductDescription"] img'),i=1;if(n.forEach(function(e){l({src:e.src,group:"详情",groupIndex:3,alt:"详情Detail-"+d(i++,2)})}),0==n.length){var c=document.createElement("script");if(c.innerText='localStorage.fatkun_runParams = window.runParams ? JSON.stringify(window.runParams) : "";',document.body.appendChild(c),localStorage.fatkun_runParams){var s=JSON.parse(localStorage.fatkun_runParams);$.ajax({url:s.detailDesc||s.data.descriptionModule.descriptionUrl,dataType:"text",success:function(e){var r=(new DOMParser).parseFromString(e,"text/html");(n=r.querySelectorAll("img")).forEach(function(e){l({src:e.src,group:"详情",groupIndex:3,alt:"详情Detail-"+i++})})}})}}}function d(e,r){return(Array(r).join(0)+e).slice(-r)}function l(t){new ParsedPItem(t,r++,e,function(r){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:e.id,item:r})})}}window.aiparser=aiparser,window.extras={downloadMJX:function(){var e=1,r=!1,t=document.createElement("script");t.innerText="localStorage.fatkun_sellerAdminSeq = window.runParams.data.commonModule.sellerAdminSeq;localStorage.fatkun_productId = window.runParams.data.commonModule.productId;",document.body.appendChild(t);var a=JSON.parse(localStorage.fatkun_sellerAdminSeq),o=JSON.parse(localStorage.fatkun_productId);function n(){var t=e;fetch("https://feedback.aliexpress.com/display/productEvaluation.htm",{headers:{"content-type":"application/x-www-form-urlencoded"},referrer:"https://feedback.aliexpress.com/display/productEvaluation.htm",referrerPolicy:"strict-origin-when-cross-origin",body:`ownerMemberId=${a}&memberType=seller&productId=${o}&companyId=&evaStarFilterValue=all+Stars&evaSortValue=sortdefault%40feedback&page=${t}&currentPage=${t-1}&startValidDate=&i18n=true&withPictures=true&withAdditionalFeedback=false&onlyFromMyCountry=false&version=&isOpened=true&translate=+Y+&jumpToTop=true&v=2`,method:"POST",mode:"cors",credentials:"include"}).then(e=>e.text()).then(e=>{var a=(new DOMParser).parseFromString(e,"text/html"),o=Array.from(a.querySelectorAll(".feedback-item"));chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:o.map((e,r)=>Array.from(e.querySelectorAll(".pic-view-item")).map((e,a)=>({src:e.dataset.src,alt:`${t}-${r+1}-${a+1}`}))).flat()}),o.length>0?r||setTimeout(n,2e3):chrome.runtime.sendMessage({cmd:"COLLECT_COMPLETED"})}),e++}chrome.runtime.sendMessage({cmd:"OPEN-OUTPUT",type:"ftk-tb-review"},function(){setTimeout(function(){chrome.runtime.sendMessage({cmd:"SUPPORT_COLLECT_PAUSE"}),n()},2e3)}),chrome.runtime.onMessage.addListener(function(e){"PAUSE_COLLECT"==e.cmd?r=!0:"RESUME_COLLECT"==e.cmd&&(r=!1,n())})}};