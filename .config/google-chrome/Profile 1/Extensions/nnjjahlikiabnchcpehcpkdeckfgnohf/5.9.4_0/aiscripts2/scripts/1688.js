function aiparser(){if(top==self){var e=0;if(chrome.runtime.sendMessage({cmd:"SET_GROUPS",groups:["主图","视频","SKU图片","详情"]}),location.href.match("detail.1688.com")){var t=document.querySelectorAll("#dt-tab img, .detail-gallery-turn img"),r=document.querySelectorAll(".obj-leading img,.table-sku img"),a=document.querySelectorAll(".de-description-detail img, #detailContentContainer img"),o=1;t.forEach(function(e){e.src.match("tbvideo.jpg")||f({src:e.dataset.lazySrc||e.src,group:"主图",groupIndex:0,alt:"主图-"+g(o++,2)})});var n=1;r.forEach(function(e){f({src:e.src,group:"SKU图片",groupIndex:2,alt:"SKU-"+g(n++,2)+"-"+e.alt})}),document.querySelectorAll(".pc-sku-wrapper .prop-img, .sku-item-image").forEach(e=>{try{var t=e.parentNode.querySelector(".sku-item-name"),r=e.nextElementSibling.title||(t?t.innerText:"");f({src:e.style.background.match('\\("(.*?)"\\)')[1],group:"SKU图片",groupIndex:2,alt:"SKU-"+g(n++,2)+"-"+r})}catch(e){}});var c=1;if(a.forEach(function(e){f({src:e.dataset.lazyloadSrc||e.src,group:"详情",groupIndex:3,alt:"详情-"+g(c++,2)})}),0==a.length){var i=$("#desc-lazyload-container").attr("data-tfs-url");i&&(i.match("desc.alicdn.com")||Date.now(),chrome.runtime.sendMessage({cmd:"NET",settings:{url:i}},function(e){if("ok"==e.status){var t=e.data.match(/https:\/\/cbu01.alicdn.com\/img[^ ]*?\.jpg/g);t&&t.forEach(function(e){f({src:e,group:"详情",groupIndex:3,alt:"详情-"+g(c++,2)})})}}))}location.href.match("detail.1688.com/pic")&&document.querySelectorAll("#dt-bp-tab-nav li[data-img]").forEach(function(e){f({src:e.dataset.img})});var d,s=document.querySelector(".mod-detail-version2018-gallery, .mod-detail-gallery");if(s&&(d=JSON.parse(s.dataset.modConfig)).userId&&d.mainVideoId){var m="https://cloud.video.taobao.com/play/u/"+d.userId+"/p/1/e/6/t/1/"+d.mainVideoId+".mp4";new VItem({src:m,group:"视频",groupIndex:1},e++,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"ADD_VIDEO",tabId:_tabInfo.id,item:e})})}var l=document.querySelector(".lib-video video");l&&new VItem({src:l.src,group:"视频",groupIndex:1},e++,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"ADD_VIDEO",tabId:_tabInfo.id,item:e})})}else if(location.href.match("albumdetail_\\d+")){var u=[];document.querySelectorAll(".image-list img").forEach(function(e,t){u.push({src:e.src})}),chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:u})}else document.querySelectorAll("img").forEach(function(e,t){new ParsedPItem(e,t,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:_tabInfo.id,item:e})})})}function g(e,t){return(Array(t).join(0)+e).slice(-t)}function f(t){t.src=t.src.replace("http://","https://"),new ParsedPItem(t,e++,_tabInfo,function(e){e.width>300&&(e.ext="jpg",chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:_tabInfo.id,item:e}))})}}window.aiparser=aiparser,window.addEventListener("contextmenu",function(e){e.stopPropagation()},!0);